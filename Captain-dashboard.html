<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Captain Dashboard Login</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-50 text-slate-900 p-6 max-w-md mx-auto">
  <h1 class="text-2xl font-bold mb-6 text-center">Team Captain Login</h1>
  <form id="loginForm" class="space-y-4">
    <div>
      <label for="email" class="block font-medium mb-1">Email</label>
      <input id="email" type="email" class="w-full p-2 border rounded-lg" required autocomplete="username"/>
    </div>
    <div>
      <label for="password" class="block font-medium mb-1">Password</label>
      <input id="password" type="password" class="w-full p-2 border rounded-lg" required autocomplete="current-password"/>
    </div>
    <div id="errorMsg" class="text-red-600 text-sm" role="alert" aria-live="assertive"></div>
    <button type="submit" class="w-full bg-blue-600 text-white p-2 rounded-lg hover:bg-blue-700 font-semibold">Login</button>
  </form>
  <div id="dashboard" class="hidden mt-6">
    <h2 class="text-xl font-semibold mb-2" id="teamName"></h2>
    <div>
      <strong>Opening Budget:</strong> ₹4,000,000
    </div>
    <div class="mt-2">
      <strong>Remaining Budget:</strong> ₹<span id="remainingBudget">0</span>
    </div>
    <h3 class="mt-4 font-semibold">Players Bought:</h3>
    <ul id="playerList" class="list-disc list-inside text-sm"></ul>
  </div>
  <script>
    // Static credentials for captains
    const CAPTAINS = [
      {email: 'ayon@org.com', password: 'Ayon1234', teamIndex: 0, teamName: 'Ayon Roy'},
      {email: 'subhojit@org.com', password: 'Subhojit1234', teamIndex: 1, teamName: 'Subhojit Dutta'},
      {email: 'ritam@org.com', password: 'Ritam1234', teamIndex: 2, teamName: 'Ritam Chowdhury'},
      {email: 'shubhanjan@org.com', password: 'Shubhanjan1234', teamIndex: 3, teamName: 'Shubhanjan Basu'},
      {email: 'srinjoy@org.com', password: 'Srinjoy1234', teamIndex: 4, teamName: 'Srinjoy Kundu'},
      {email: 'subhamoy@org.com', password: 'Subhamoy1234', teamIndex: 5, teamName: 'Subhamoy Das'},
    ];

    const loginForm = document.getElementById('loginForm');
    const errorMsg = document.getElementById('errorMsg');
    const dashboard = document.getElementById('dashboard');
    const teamNameEl = document.getElementById('teamName');
    const remainingBudgetEl = document.getElementById('remainingBudget');
    const playerListEl = document.getElementById('playerList');

    loginForm.addEventListener('submit', e => {
      e.preventDefault();
      errorMsg.textContent = '';
      const email = loginForm.email.value.trim().toLowerCase();
      const password = loginForm.password.value;

      // Fix: use === for comparison
      const captain = CAPTAINS.find(c => c.email === email && c.password === password);

      if (!captain) {
        errorMsg.textContent = 'Invalid email or password.';
        return;
      }
      // Hide login form and show dashboard
      loginForm.style.display = 'none';
      dashboard.classList.remove('hidden');
      // Show captain info
      teamNameEl.textContent = captain.teamName;
      updateBudgetAndPlayers(captain.teamIndex);
      // Refresh data every 5 seconds
      setInterval(() => updateBudgetAndPlayers(captain.teamIndex), 5000);
    });

    function updateBudgetAndPlayers(teamIndex) {
      const budgets = JSON.parse(localStorage.getItem('auctionBudgets')) || [];
      const sales = JSON.parse(localStorage.getItem('auctionSales')) || [];

      remainingBudgetEl.textContent = budgets[teamIndex] !== undefined ? budgets[teamIndex].toLocaleString('en-IN') : '0';

      const players = sales.filter(s => s.teamIndex == teamIndex);
      playerListEl.innerHTML = '';
      if (players.length === 0) {
        playerListEl.innerHTML = '<li>No players bought yet.</li>';
        return;
      }
      players.forEach(p => {
        const li = document.createElement('li');
        li.textContent = `${p.playerName} - ₹${p.price.toLocaleString('en-IN')}`;
        playerListEl.appendChild(li);
      });
    }
  </script>
</body>
</html>